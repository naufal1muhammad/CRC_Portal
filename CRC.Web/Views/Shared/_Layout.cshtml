<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - CRC.Web</title>

    <!-- ===============================================-->
    <!--    Favicons-->
    <!-- ===============================================-->
    <link rel="icon" type="image/png" sizes="32x32" href="~/images/cancer-icon.png" />
    <meta name="theme-color" content="#ffffff">
    <script src="~/lib/falcon/public/assets/js/config.js"></script>
    <script src="~/lib/falcon/public/vendors/simplebar/simplebar.min.js"></script>
    <script src="~/lib/falcon/public/vendors/chart/chart.min.js"></script>

    <!-- ===============================================-->
    <!--    Stylesheets-->
    <!-- ===============================================-->
    <link rel="stylesheet" href="~/lib/falcon/public/vendors/nouislider/nouislider.min.css">
    <link rel="stylesheet" href="~/lib/falcon/public/vendors/simplebar/simplebar.min.css">
    <link rel="stylesheet" href="~/lib/falcon/public/assets/css/theme-rtl.min.css" id="style-rtl">
    <link rel="stylesheet" href="~/lib/falcon/public/assets/css/theme.min.css" id="style-default">
    <link rel="stylesheet" href="~/lib/falcon/public/assets/css/user-rtl.min.css" id="user-style-rtl">
    <link rel="stylesheet" href="~/lib/falcon/public/assets/css/user.min.css" id="user-style-default">
    <script>
        var isRTL = JSON.parse(localStorage.getItem('isRTL'));
        if (isRTL) {
            var linkDefault = document.getElementById('style-default');
            var userLinkDefault = document.getElementById('user-style-default');
            linkDefault.setAttribute('disabled', true);
            userLinkDefault.setAttribute('disabled', true);
            document.querySelector('html').setAttribute('dir', 'rtl');
        } else {
            var linkRTL = document.getElementById('style-rtl');
            var userLinkRTL = document.getElementById('user-style-rtl');
            linkRTL.setAttribute('disabled', true);
            userLinkRTL.setAttribute('disabled', true);
        }
    </script>

    <!-- ===============================================-->
    <!--    Extras-->
    <!-- ===============================================-->
    <link rel="stylesheet" href="~/fonts/opensans.css">
    <link rel="stylesheet" href="~/lib/falcon/public/vendors/bootstrap-icons/bootstrap-icons.css">
    <link rel="stylesheet" href="~/lib/smartwizard/dist/css/smart_wizard_all.min.css">
    <link rel="stylesheet" href="~/lib/toastify-js/src/toastify.css">
    <link rel="stylesheet" href="~/lib/falcon/public/vendors/choices/choices.min.css">
    <link rel="stylesheet" href="~/lib/falcon/public/vendors/datatables.net-bs5/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="~/lib/falcon/public/vendors/datatables.net-buttons/css/buttons.bootstrap5.min.css">
    <link rel="stylesheet" href="~/lib/falcon/public/vendors/datatables.net-responsive/css/responsive.bootstrap5.min.css">
    <link rel="stylesheet" href="~/lib/falcon/public/vendors/dropzone/dropzone.min.css">
    <link rel="stylesheet" href="~/lib/falcon/public/vendors/flatpickr/flatpickr.min.css">
    <link rel="stylesheet" href="~/lib/falcon/public/vendors/flatpickr/plugins/monthSelect/style.css">
    <link rel="stylesheet" href="~/lib/falcon/public/vendors/overlayscrollbars/OverlayScrollbars.min.css">
    <link rel="stylesheet" href="~/lib/falcon/public/vendors/select2/select2.min.css">
    <link rel="stylesheet" href="~/lib/falcon/public/vendors/select2-bootstrap-5-theme/select2-bootstrap-5-theme.min.css">
    <link rel="stylesheet" href="~/lib/jstree/themes/default/style.min.css" />
    <link rel="stylesheet" href="~/lib/highlight/styles/github-dark-dimmed.min.css" />
    <link rel="stylesheet" href="~/css/site.css">

    @await RenderSectionAsync("Stylesheets", required: false)

</head>

<body class="bg-light">
    <div class="d-flex" id="layoutWrapper">
        <!-- Sidebar -->
        <nav class="flex-shrink-0 sidebar-main primary-color border-end">
            <div class="p-3 border-bottom">
                <a asp-controller="Dashboard" asp-action="Index" class="navbar-brand fw-bold text-decoration-none">
                    CRC Web Portal
                </a>
            </div>

            <div class="list-group list-group-flush">
                @{
                    string currentController = ViewContext.RouteData.Values["controller"]?.ToString() ?? "";
                    string currentAction = ViewContext.RouteData.Values["action"]?.ToString() ?? "";
                    Func<string, string, string> activeClass = (controller, action) =>
                    string.Equals(currentController, controller, StringComparison.OrdinalIgnoreCase)
                    ? "active"
                    : "";
                }
                @{
                    bool isBranchSectionActive =
                    string.Equals(currentController, "Branch", StringComparison.OrdinalIgnoreCase) ||
                    string.Equals(currentController, "Asset", StringComparison.OrdinalIgnoreCase);
                }

                <a asp-controller="Dashboard" asp-action="Index"
                   class="list-group-item list-group-item-action @activeClass("Dashboard", "Index")">
                    <i class="fas fa-home me-2"></i> Dashboard
                </a>

                <a asp-controller="Patient" asp-action="Index"
                   class="list-group-item list-group-item-action @activeClass("Patient", "Index")">
                    <i class="fas fa-user-injured me-2"></i> Patient
                </a>

                <a asp-controller="Staff" asp-action="Index"
                   class="list-group-item list-group-item-action @activeClass("Staff", "Index")">
                    <i class="fas fa-user-md me-2"></i> Staff
                </a>

                <!-- Branch dropdown -->
                <a class="list-group-item list-group-item-action d-flex align-items-center justify-content-between sidebar-branch-toggle @(isBranchSectionActive ? "" : "collapsed")"
                   data-bs-toggle="collapse"
                   href="#sidebarBranchCollapse"
                   role="button"
                   aria-expanded="@(isBranchSectionActive.ToString().ToLower())"
                   aria-controls="sidebarBranchCollapse">
                    <span>
                        <i class="fas fa-code-branch me-2"></i> Branch
                    </span>
                    <i class="fas fa-chevron-down small branch-toggle-icon"></i>
                </a>

                <div class="collapse @(isBranchSectionActive ? "show" : "")" id="sidebarBranchCollapse">
                    <a asp-controller="Branch" asp-action="Index"
                       class="list-group-item list-group-item-action border-0 ps-4 @activeClass("Branch", "Index")">
                        <i class="fas fa-building me-2"></i> Branch List
                    </a>
                    <a asp-controller="Asset" asp-action="Index"
                       class="list-group-item list-group-item-action border-0 ps-4 @activeClass("Asset", "Index")">
                        <i class="fas fa-boxes-stacked me-2"></i> Asset Management
                    </a>
                </div>

                <a asp-controller="DocumentManagement" asp-action="Index"
                   class="list-group-item list-group-item-action @activeClass("DocumentManagement", "Index")">
                    <i class="fas fa-folder-open me-2"></i> Document Management
                </a>

                <!-- Reports (placeholder for future) -->
                <a asp-controller="Reports" asp-action="Index"
                   class="list-group-item list-group-item-action disabled">
                    <i class="fas fa-chart-line me-2"></i> Reports (coming soon)
                </a>
                <!-- Reports (placeholder for future) -->
                <a asp-controller="CostCenter" asp-action="Index"
                   class="list-group-item list-group-item-action disabled">
                    <i class="fas fa-solid fa-coins me-2"></i> Cost-center (coming soon)
                </a>

                <!-- Spacer -->
                <div class="flex-grow-1"></div>

                <!-- Logout -->
                <a asp-controller="Account" asp-action="Logout"
                   class="list-group-item list-group-item-action text-danger mt-auto">
                    <i class="fas fa-sign-out-alt me-2"></i> Logout
                </a>
            </div>
        </nav>

        <!-- Main content -->
        <div class="flex-grow-1 d-flex flex-column">

            <!-- Top bar -->
            <header class="navbar navbar-expand navbar-light bg-light px-3">
                <div class="ms-auto d-flex align-items-center">
                    @{
                        var fullName = User.Claims.FirstOrDefault(c => c.Type == "FullName")?.Value
                        ?? User.Identity?.Name
                        ?? "Administrator";
                    }
                    <span class="me-2 text-muted"><i class="fas fa-user-circle me-1"></i> @fullName</span>
                </div>
            </header>

            <!-- Page content -->
            <main class="flex-grow-1 p-3">
                <div class="container-fluid">
                    @RenderBody()
                </div>
            </main>

            <!-- Footer -->
            <footer class="bg-light border-top text-center py-2 small text-muted">
                &copy; @DateTime.Now.Year - CRC Web Portal
            </footer>
        </div>
    </div>

    <!-- Scripts -->
    <!-- ===============================================-->
    <!--    JavaScripts-->
    <!-- ===============================================-->
    <script src="~/lib/falcon/public/vendors/popper/popper.min.js"></script>
    <script src="~/lib/falcon/public/vendors/bootstrap/bootstrap.min.js"></script>
    <script src="~/lib/falcon/public/vendors/anchorjs/anchor.min.js"></script>
    <script src="~/lib/falcon/public/vendors/is/is.min.js"></script>
    <script src="~/lib/falcon/public/vendors/nouislider/nouislider.min.js"></script>
    <script src="~/lib/falcon/public/vendors/fontawesome/all.min.js"></script>
    <script src="~/lib/falcon/public/vendors/lodash/lodash.min.js"></script>
    <script src="~/lib/falcon/public/vendors/list.js/list.min.js"></script>
    <script src="~/lib/falcon/public/assets/js/theme.js"></script>

    <!-- ===============================================-->
    <!--    Extras-->
    <!-- ===============================================-->
    <script src="~/lib/falcon/public/vendors/jquery/jquery.min.js"></script>
    <script src="~/lib/jquery-csv/jquery.csv.min.js"></script>
    <script src="~/lib/moment.js/moment.min.js"></script>
    <script src="~/lib/toastify-js/src/toastify.js"></script>
    <script src="~/lib/saveSvgAsPng/saveSvgAsPng.js"></script>
    <script src="~/lib/smartwizard/dist/js/jquery.smartWizard.min.js"></script>
    <script src="~/lib/bs-custom-file-input/bs-custom-file-input.min.js"></script>
    <script src="~/lib/falcon/public/vendors/choices/choices.min.js"></script>
    <script src="~/lib/falcon/public/vendors/dropzone/dropzone.min.js"></script>
    <script src="~/lib/falcon/public/vendors/d3/d3.v7.min.js"></script>
    <script src="~/lib/falcon/public/vendors/echarts/echarts.min.js"></script>
    <script src="~/lib/falcon/public/vendors/lottie/lottie.min.js"></script>
    <script src="~/lib/falcon/public/vendors/jszip/jszip.min.js"></script>
    <script src="~/lib/falcon/public/vendors/pdfmake/pdfmake.js"></script>
    <script src="~/lib/falcon/public/vendors/pdfmake/vfs_fonts.js"></script>
    <script src="~/lib/falcon/public/vendors/datatables.net/jquery.dataTables.min.js"></script>
    <script src="~/lib/falcon/public/vendors/datatables.net-bs5/dataTables.bootstrap5.min.js"></script>
    <script src="~/lib/falcon/public/vendors/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
    <script src="~/lib/falcon/public/vendors/datatables.net-buttons/js/buttons.bootstrap5.min.js"></script>
    <script src="~/lib/falcon/public/vendors/datatables.net-buttons/js/buttons.print.min.js"></script>
    <script src="~/lib/falcon/public/vendors/datatables.net-buttons/js/buttons.html5.min.js"></script>
    <script src="~/lib/falcon/public/vendors/datatables.net-fixedcolumns/dataTables.fixedColumns.min.js"></script>
    <script src="~/lib/falcon/public/vendors/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
    <script src="~/lib/falcon/public/vendors/datatables.net-responsive/js/responsive.bootstrap5.min.js"></script>
    <script src="~/lib/falcon/public/vendors/datatables-plugins/sorting/datetime-moment.min.js"></script>
    <script src="~/lib/falcon/public/vendors/overlayscrollbars/OverlayScrollbars.min.js"></script>
    <script src="~/lib/falcon/public/vendors/prism/prism.js"></script>
    <script src="~/lib/falcon/public/vendors/select2/select2.min.js"> </script>
    <script src="~/lib/falcon/public/vendors/select2/select2.full.min.js"> </script>
    <script src="~/lib/falcon/public/vendors/validator/validator.min.js"></script>
    <script src="~/lib/falcon/public/vendors/dayjs/dayjs.min.js"></script>
    <script src="~/lib/falcon/public/vendors/flatpickr/flatpickr.min.js"></script>
    <script src="~/lib/falcon/public/vendors/flatpickr/plugins/monthSelect/index.js"></script>
    <script src="~/lib/falcon/public/assets/js/flatpickr.js"></script>
    <script src="~/lib/apexcharts/dist/apexcharts.js"></script>
    <script src="~/lib/falcon/public/vendors/countup/countUp.umd.js"></script>
    <script src="~/lib/falcon/public/vendors/typed.js/typed.js"></script>
    <script src="~/lib/jstree/jstree.min.js"></script>
    <script src="~/lib/highlight/highlight.min.js"></script>
    <script src="~/lib/highlight/languages/sql.min.js"></script>
    <script src="~/lib/xlsx/package/dist/xlsx.full.min.js"></script>

    <!-- ===============================================-->
    <!--    Custom-->
    <!-- ===============================================-->
    <script src="~/js/functions/GetPropertyValue.js"></script>
    <script src="~/js/classes/Resource.js"></script>
    <script src="~/js/common/toast.js"></script>
    <script src="~/js/common/form.js"></script>
    <script src="~/js/common/modalFalcon.js"></script>
    <script src="~/js/common/logger.js"></script>
    <script src="~/js/functions/ConfirmationModalFalcon.js"></script>
    <script src="~/js/functions/Crud.js"></script>
    <script src="~/js/functions/DataTable.js"></script>
    <script src="~/js/functions/DataTableDataManagement.js"></script>
    <script src="~/js/functions/SmartWizard.js"></script>
    <script src="~/js/functions/SrollTop.js"></script>
    <script src="~/js/functions/UrlVariable.js"></script>
    <script src="~/js/functions/SessionTimeout.js"></script>
    <script src="~/js/functions/LoadingModal.js"></script>
    <script src="~/js/helpers/FormValidatorFalcon.js"></script>
    <script src="~/js/builders/customs/ApplicationGroupSelection.js"></script>
    <script src="~/js/builders/inputs/DataListElement.js"></script>
    <script src="~/js/builders/inputs/DateElement.js"></script>
    <script src="~/js/builders/inputs/SelectElement.js"></script>
    <script src="~/js/builders/inputs/SelectBooleanElement.js"></script>
    <script src="~/js/builders/customs/FilterNextSelectElement.js"></script>
    <script src="~/js/builders/DataTableFalcon.js"></script>
    <script src="~/js/builders/ListCheckbox.js"></script>
    <script src="~/js/builders/ListGroup.js"></script>
    <script src="~/js/builders/ListSelection.js"></script>
    <script src="~/js/builders/MatrixCheckbox.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>

    @await RenderSectionAsync("Scripts", required: false)

</body>
</html>